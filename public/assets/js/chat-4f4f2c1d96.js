let contactsSearchHandler=function(e){$.ajax({type:"get",url:`/chat/get-contacts/?text=${e}`,success:function(e){let t=e.data.usersList;for(user of($(".contacts-list").empty(),t))$(".contacts-list").append(`\n                    <div class = "contact-item waves-effect waves-teal" data-contactID = "${user._id}">\n                        <div class = "contact-name-image-container">\n                            <div class = "contact-item-image">\n                                <img src = "${user.avatar}" alt="" class = "circle responsive-img user-image">\n                            </div>\n                            <div class = "contact-item-name">\n                                ${user.name}\n                            </div>\n                        </div>\n\n                        <div class = "new-message-badge">\n\n                        </div>\n                    </div>\n                `)},error:function(e){console.log(e.message)}})};$("#contacts-search-bar").on("keyup",(function(e){let t=e.target.value;contactsSearchHandler(t)}));let contactClickAJAXHandler=function(e){let t=e.attr("data-contactID");$.ajax({type:"get",url:`/chat/fetch-user/?id=${t}`,success:function(a){for(message of(e.addClass("active-chat-contact"),$(".contact-image").empty(),$(".contact-image").append(`\n                <img src = "${a.data.user.avatar}" alt = "" class = "circle responsive-img user-image">\n            `),$(".contact-name").text(a.data.user.name),$(".messages-container").attr("data-contactID",a.data.user._id),$(".contact-messages").empty(),a.data.messageList)){let e;e=message.to==t?"sender-message":"receiver-message","sender-message"==e?$(".contact-messages").append(`\n                        <div class = "message">\n                            <div class = "col xs0 s1 m2 l3 xl3">\n\n                            </div>\n                            <div class = "${e}">\n                                ${message.content}\n                            </div>\n                        </div>\n                    `):$(".contact-messages").append(`\n                        <div class = "message">\n                            <div class = "${e}">\n                                ${message.content}\n                            </div>\n                            <div class = "col xs0 s1 m2 l3 xl3">\n\n                            </div>\n                        </div>\n                    `)}$(".contact-messages").scrollTop($(".contact-messages")[0].scrollHeight),e.children(".new-message-badge").empty()},error:function(e){console.log("Error while fetching user")}})},contactClickHandler=function(e){for(contact of $(".contacts-list").children())if($(contact).hasClass("active-chat-contact")){$(contact).removeClass("active-chat-contact");break}contactClickAJAXHandler(e)};$(".contacts-list").on("click",".contact-item",(function(e){let t=$(this);0==t.hasClass("active-chat-contact")&&contactClickHandler(t)}));let messageSenderHandler=function(e,t){$.ajax({type:"post",url:"/chat/create-message",data:{from:ChatEngine.userID,to:e,message:t},success:function(a){ChatEngine.messageSenderEventEmitter(e,t),$($(".message-field-input")[0]).val(""),$(".contact-messages").append(`\n                <div class = "message">\n                    <div class = "col xs0 s1 m2 l3 xl3">\n\n                    </div>\n                    <div class = "sender-message">\n                        ${t}\n                    </div>\n                </div>\n            `),$(".contact-messages").scrollTop($(".contact-messages")[0].scrollHeight)},error:function(e){errorNotification(e.responseJSON,"Error while creating message")}})};$(".message-field").on("submit",(function(e){e.preventDefault();let t=$($(".message-field-input")[0]).val(),a=e.target.parentElement.getAttribute("data-contactID");""==a?errorNotification({},"Select a User First!"):messageSenderHandler(a,t)}));